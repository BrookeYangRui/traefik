# CVE-2025-XXXXX: HTTP Header Injection in SitecorePowerShell/Console Traefik Configuration

## 基本信息

- **CVE ID**: CVE-2025-XXXXX (待分配)
- **项目**: SitecorePowerShell/Console
- **发现日期**: 2025-12-28
- **报告者**: Security Research
- **严重程度**: High (CVSS 7.5)

## 漏洞描述

SitecorePowerShell/Console 项目中的 Traefik Docker Compose 配置存在 HTTP Header Injection (CRLF Injection) 漏洞。配置文件中设置了 `forwardedHeaders.insecure` 但没有配置 `trustedIPs` 白名单，导致 Traefik 信任所有来源的 X-Forwarded-* 头。

## 受影响文件

- `docker-compose.yml`

## 漏洞配置

```yaml
command:
  - "--entryPoints.websecure.forwardedHeaders.insecure"
```

## 漏洞详情

### 问题分析

1. **配置问题**: `forwardedHeaders.insecure` 且**没有配置 trustedIPs**
2. **影响**: Traefik 会信任**所有来源**的 X-Forwarded-* 头
3. **攻击向量**: 攻击者可以直接向 Traefik 发送恶意请求

### 攻击场景

同 CVE-2025-XXXXX-hmcts-cnp-flux-config

## 影响评估

### CVSS 3.1 评分

- **Base Score**: 7.5 (High)
- **Vector**: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N

### 实际影响

同 CVE-2025-XXXXX-hmcts-cnp-flux-config

## 修复建议

### 方案 1: 移除 insecure 配置（推荐）

```yaml
# 移除这一行
# - "--entryPoints.websecure.forwardedHeaders.insecure"
```

### 方案 2: 配置 trustedIPs 白名单

```yaml
command:
  - "--entryPoints.websecure.forwardedHeaders.insecure"
  - "--entryPoints.websecure.forwardedHeaders.trustedIPs=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16"
```

## 备注

这是实际项目配置（114 stars），可能被用于生产环境。建议尽快修复。

