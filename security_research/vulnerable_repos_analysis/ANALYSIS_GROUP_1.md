# ç¬¬ä¸€ç»„é¡¹ç›®åˆ†æï¼ˆå‰5ä¸ªï¼‰

## é¡¹ç›®åˆ—è¡¨

1. **hmcts/cnp-flux-config** - è‹±å›½å¸æ³•éƒ¨
2. **tomMoulard/fail2ban** - CI æµ‹è¯•é…ç½®
3. **SitecorePowerShell/Console** - Docker Compose
4. **deepsquare-io/ClusterFactory** - Helm values
5. **Azure-Samples/netai-chat-with-your-data** - Azure ç¤ºä¾‹

---

## é¡¹ç›® 1: hmcts/cnp-flux-config

### é…ç½®åˆ†æ

**æ–‡ä»¶**: `apps/admin/traefik2/ptl-intsvc/00.yaml`

```yaml
additionalArguments:
  - "--entryPoints.web.forwardedHeaders.insecure=true"
  - "--entryPoints.websecure.forwardedHeaders.insecure=true"
```

### å¨èƒæ¨¡å‹åˆ†æ

âœ… **ç¡®è®¤å­˜åœ¨æ¼æ´**:
- `insecure=true` ä¸”**æ²¡æœ‰é…ç½® trustedIPs**
- è¿™æ„å‘³ç€ Traefik ä¼šä¿¡ä»»**æ‰€æœ‰æ¥æº**çš„ X-Forwarded-* å¤´

### åˆ©ç”¨æ–¹å¼

1. **æ”»å‡»è·¯å¾„**:
   ```
   æ”»å‡»è€… â†’ ç›´æ¥è®¿é—® Traefik â†’ åç«¯æœåŠ¡
   ```

2. **æ”»å‡»è½½è·**:
   ```http
   GET / HTTP/1.1
   Host: target.com
   X-Forwarded-For: 127.0.0.1\r\nX-Injected: malicious\r\n
   ```

3. **å®é™…å½±å“**:
   - âœ… **æ—¥å¿—æ³¨å…¥**: å‡ ä¹è‚¯å®šå‘ç”Ÿï¼ˆåç«¯æœåŠ¡ä¼šè®°å½• X-Forwarded-Forï¼‰
   - âœ… **IP æ¬ºéª—**: å¦‚æœåç«¯ä½¿ç”¨ X-Forwarded-For è¿›è¡Œè®¿é—®æ§åˆ¶
   - âš ï¸ **å“åº”æ‹†åˆ†**: éœ€è¦åç«¯åœ¨å“åº”ä¸­å›æ˜¾è¯¥å€¼

### å®é™…å½±å“è¯„ä¼°

**å½±å“ç­‰çº§**: ğŸ”´ **é«˜**

**åŸå› **:
1. **æ”¿åºœæœºæ„é…ç½®** - å¯èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
2. **æ²¡æœ‰ç™½åå•** - ä»»ä½•æ¥æºéƒ½å¯ä»¥æ³¨å…¥
3. **å®é™…å½±å“** - æ—¥å¿—æ³¨å…¥å’Œ IP æ¬ºéª—å¾ˆå¯èƒ½å‘ç”Ÿ

### ç»“è®º

âœ… **ç¡®è®¤å­˜åœ¨çœŸå®æ¼æ´ï¼Œéœ€è¦ç”Ÿæˆ CVE æŠ¥å‘Š**

---

## é¡¹ç›® 2: tomMoulard/fail2ban

### é…ç½®åˆ†æ

**æ–‡ä»¶**: `ci/yamls/traefik-ci.yaml`

```yaml
entryPoints:
  http:
    address: ":8000"
    forwardedHeaders:
      insecure: true
```

### å¨èƒæ¨¡å‹åˆ†æ

âœ… **ç¡®è®¤å­˜åœ¨æ¼æ´**:
- `insecure=true` ä¸”**æ²¡æœ‰é…ç½® trustedIPs**
- è¿™æ˜¯ CI æµ‹è¯•é…ç½®ï¼Œä½†å¯èƒ½è¢«å¤åˆ¶åˆ°ç”Ÿäº§ç¯å¢ƒ

### åˆ©ç”¨æ–¹å¼

åŒé¡¹ç›®1ï¼Œä½†è¿™æ˜¯ CI é…ç½®ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚

### å®é™…å½±å“è¯„ä¼°

**å½±å“ç­‰çº§**: âš ï¸ **ä¸­ç­‰**

**åŸå› **:
1. **CI æµ‹è¯•é…ç½®** - å¯èƒ½ä¸åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
2. **ä½†å¯èƒ½è¢«å¤åˆ¶** - å¼€å‘è€…å¯èƒ½å¤åˆ¶è¿™ä¸ªé…ç½®åˆ°ç”Ÿäº§
3. **å®é™…å½±å“** - å¦‚æœç”¨äºç”Ÿäº§ï¼Œå½±å“åŒé¡¹ç›®1

### ç»“è®º

âš ï¸ **å­˜åœ¨æ¼æ´ï¼Œä½†ä¸»è¦ç”¨äº CIï¼Œå½±å“æœ‰é™ã€‚å»ºè®®ä¿®å¤ä½†ä¸éœ€è¦ CVEã€‚**

---

## é¡¹ç›® 3: SitecorePowerShell/Console

### é…ç½®åˆ†æ

**æ–‡ä»¶**: `docker-compose.yml`

```yaml
command:
  - "--entryPoints.websecure.forwardedHeaders.insecure"
```

### å¨èƒæ¨¡å‹åˆ†æ

âœ… **ç¡®è®¤å­˜åœ¨æ¼æ´**:
- `forwardedHeaders.insecure` ä¸”**æ²¡æœ‰é…ç½® trustedIPs**
- è¿™æ˜¯ Docker Compose é…ç½®ï¼Œå¯èƒ½ç”¨äºå¼€å‘æˆ–ç”Ÿäº§

### åˆ©ç”¨æ–¹å¼

åŒé¡¹ç›®1ã€‚

### å®é™…å½±å“è¯„ä¼°

**å½±å“ç­‰çº§**: ğŸ”´ **é«˜**

**åŸå› **:
1. **å®é™…é¡¹ç›®é…ç½®** - 114 starsï¼Œå¯èƒ½è¢«ä½¿ç”¨
2. **æ²¡æœ‰ç™½åå•** - ä»»ä½•æ¥æºéƒ½å¯ä»¥æ³¨å…¥
3. **å®é™…å½±å“** - æ—¥å¿—æ³¨å…¥å’Œ IP æ¬ºéª—å¾ˆå¯èƒ½å‘ç”Ÿ

### ç»“è®º

âœ… **ç¡®è®¤å­˜åœ¨çœŸå®æ¼æ´ï¼Œéœ€è¦ç”Ÿæˆ CVE æŠ¥å‘Š**

---

## é¡¹ç›® 4: deepsquare-io/ClusterFactory

### é…ç½®åˆ†æ

**æ–‡ä»¶**: `core.example/traefik/values.yaml`

```yaml
additionalArguments:
  - '--entryPoints.websecure.proxyProtocol.insecure'
  - '--entryPoints.websecure.forwardedHeaders.insecure'
```

### å¨èƒæ¨¡å‹åˆ†æ

âš ï¸ **ç¤ºä¾‹æ–‡ä»¶**:
- è¿™æ˜¯ `core.example` ç›®å½•ä¸‹çš„ç¤ºä¾‹é…ç½®
- å¯èƒ½è¢«ç”¨æˆ·å¤åˆ¶ä½¿ç”¨ï¼Œä½†æœ¬èº«ä¸æ˜¯å®é™…éƒ¨ç½²

### åˆ©ç”¨æ–¹å¼

å¦‚æœç”¨æˆ·å¤åˆ¶è¿™ä¸ªé…ç½®åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œå½±å“åŒé¡¹ç›®1ã€‚

### å®é™…å½±å“è¯„ä¼°

**å½±å“ç­‰çº§**: âš ï¸ **ä¸­ç­‰**

**åŸå› **:
1. **ç¤ºä¾‹æ–‡ä»¶** - ä¸æ˜¯å®é™…éƒ¨ç½²é…ç½®
2. **ä½†å¯èƒ½è¢«å¤åˆ¶** - ç”¨æˆ·å¯èƒ½å¤åˆ¶åˆ°ç”Ÿäº§ç¯å¢ƒ
3. **å®é™…å½±å“** - å¦‚æœç”¨äºç”Ÿäº§ï¼Œå½±å“åŒé¡¹ç›®1

### ç»“è®º

âš ï¸ **ç¤ºä¾‹æ–‡ä»¶ï¼Œå­˜åœ¨é£é™©ä½†å½±å“æœ‰é™ã€‚å»ºè®®ä¿®å¤ä½†ä¸éœ€è¦ CVEã€‚**

---

## é¡¹ç›® 5: Azure-Samples/netai-chat-with-your-data

### é…ç½®åˆ†æ

**æ–‡ä»¶**: `infra/uidocsmngr.tmpl.yaml`

è¿™ä¸ªæ–‡ä»¶æ˜¯ **Azure Container Apps** çš„é…ç½®ï¼Œä¸æ˜¯ Traefik é…ç½®ã€‚

éœ€è¦æŸ¥æ‰¾å®é™…çš„ Traefik é…ç½®æ–‡ä»¶ã€‚

### å¨èƒæ¨¡å‹åˆ†æ

â“ **éœ€è¦è¿›ä¸€æ­¥ç¡®è®¤**:
- è¿™ä¸ªæ–‡ä»¶ä¸åŒ…å« Traefik é…ç½®
- å¯èƒ½ Traefik é…ç½®åœ¨å…¶ä»–æ–‡ä»¶ä¸­
- æˆ–è€…è¿™ä¸ªé¡¹ç›®ä¸ä½¿ç”¨ Traefik

### ç»“è®º

âŒ **å½“å‰æ–‡ä»¶ä¸æ˜¯ Traefik é…ç½®ï¼Œè·³è¿‡ã€‚éœ€è¦æŸ¥æ‰¾å…¶ä»–é…ç½®æ–‡ä»¶ã€‚**

---

## ç¬¬ä¸€ç»„æ€»ç»“

### ç¡®è®¤å­˜åœ¨çœŸå®æ¼æ´ï¼ˆéœ€è¦ CVEï¼‰

1. âœ… **hmcts/cnp-flux-config** - æ”¿åºœæœºæ„é…ç½®ï¼Œé«˜é£é™©
2. âœ… **SitecorePowerShell/Console** - å®é™…é¡¹ç›®é…ç½®ï¼Œé«˜é£é™©

### å­˜åœ¨æ¼æ´ä½†å½±å“æœ‰é™ï¼ˆå»ºè®®ä¿®å¤ï¼Œä¸éœ€è¦ CVEï¼‰

3. âš ï¸ **tomMoulard/fail2ban** - CI é…ç½®
4. âš ï¸ **deepsquare-io/ClusterFactory** - ç¤ºä¾‹æ–‡ä»¶

### éœ€è¦è¿›ä¸€æ­¥ç¡®è®¤

5. â“ **Azure-Samples/netai-chat-with-your-data** - å½“å‰æ–‡ä»¶ä¸æ˜¯ Traefik é…ç½®

---

## ä¸‹ä¸€æ­¥

1. ä¸ºé¡¹ç›® 1 å’Œ 3 ç”Ÿæˆ CVE æŠ¥å‘Š
2. ç»§ç»­åˆ†æä¸‹ä¸€ç»„é¡¹ç›®

